<!DOCTYPE html><html><head><title>Native Modules</title><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width"><meta property="fb:app_id" content="1677033832619985"><meta property="fb:admins" content="121800083"><meta property="og:site_name" content="React Native"><meta property="og:title" content="Native Modules"><meta property="og:url" content="https://facebook.github.io/react-vr/index.html"><meta property="og:image" content="https://facebook.github.io/react-native/img/opengraph.png"><meta property="og:description" content="A framework for building native apps using React"><meta name="twitter:site" content="@reactnative"><meta name="twitter:card" content="summary_large_image"><meta property="og:type" content="website"><base href="../"><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"><link rel="shortcut icon" href="img/favicon.png?2"><link rel="stylesheet" href="css/react-native.css"><link rel="alternate" type="application/rss+xml" title="React Native Blog" href="https://facebook.github.io/react-vr/blog/feed.xml"><link href="https://cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="https://use.typekit.net/vqa1hcx.js"></script><script type="text/javascript">try{Typekit.load();}catch(e){}</script></head><body><script>window.fbAsyncInit = function() {FB.init({appId:'1677033832619985',xfbml:true,version:'v2.7'});};(function(d, s, id){var js, fjs = d.getElementsByTagName(s)[0];if (d.getElementById(id)) {return;}js = d.createElement(s); js.id = id;js.src = 'https://connect.facebook.net/en_US/sdk.js';fjs.parentNode.insertBefore(js, fjs);}(document, 'script','facebook-jssdk'));</script><script>window.twttr=(function(d,s, id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return t;js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js, fjs);t._e = [];t.ready = function(f) {t._e.push(f);};return t;}(document, "script", "twitter-wjs"));</script><div class="container"><div class="nav-main"><div class="wrap"><a class="nav-home" href="./index.html"><img src="img/header_logo.png">React VR</a><div class="nav-site-wrapper"><ul class="nav-site nav-site-internal"><li><a href="docs/getting-started.html" class="active" data-target=".nav-docs">Docs</a></li></ul><ul class="nav-site nav-site-external"><li><a href="https://github.com/facebookincubator/react-vr" class="">GitHub</a></li><li><a href="http://facebook.github.io/react" class="">React</a></li><li><a href="http://facebook.github.io/react-native" class="">React Native</a></li></ul></div></div></div><section class="content wrap documentationContent"><div class="nav-docs"><div class="nav-docs-viewport"><div class="nav-docs-section"><h3>The Basics</h3><ul><li><a style="margin-left:0;" class="" href="docs/getting-started.html">Getting Started</a></li><li><a style="margin-left:0;" class="" href="docs/tutorial.html">Hello World</a></li><li><a style="margin-left:0;" class="" href="docs/project-configuration.html">Project Configuration</a></li><li><a style="margin-left:0;" class="" href="docs/publishing.html">Publishing Your Project</a></li><li><a style="margin-left:0;" class="" href="docs/react-vroverview.html">React VR Overview</a></li><li><a style="margin-left:0;" class="" href="docs/components-props-and-state.html">Components, Props and State</a></li><li><a style="margin-left:0;" class="" href="docs/layout-and-style.html">Layout and Style</a></li><li><a style="margin-left:0;" class="" href="docs/3dcoordinates-and-transforms.html">3D Coordinates and Transforms</a></li><li><a style="margin-left:0;" class="" href="docs/input.html">Handling Input</a></li><li><a style="margin-left:0;" class="" href="docs/fonts.html">Fonts and Text</a></li><li><a style="margin-left:0;" class="" href="docs/vrbrowsers.html">VR Browsers</a></li><li><a style="margin-left:0;" class="" href="docs/dev-tools.html">Dev Tools</a></li><li><a style="margin-left:0;" class="" href="docs/release-change-log.html">Release Changelog</a></li></ul></div><div class="nav-docs-section"><h3>Guides</h3><ul><li><a style="margin-left:0;" class="" href="docs/animations.html">Animations</a></li><li><a style="margin-left:0;" class="" href="docs/colors.html">Colors</a></li><li><a style="margin-left:0;" class="" href="docs/debugging.html">Debugging</a></li><li><a style="margin-left:0;" class="" href="docs/images.html">Images</a></li><li><a style="margin-left:0;" class="" href="docs/timers.html">Timers</a></li><li><a style="margin-left:0;" class="active" href="docs/native-modules.html">Native Modules</a></li><li><a style="margin-left:0;" class="" href="docs/platform-specific-information.html">Platform Specific Code</a></li><li><a style="margin-left:0;" class="" href="docs/samples.html">Samples</a></li></ul></div><div class="nav-docs-section"><h3>core components</h3><ul><li><a style="margin-left:0;" class="" href="docs/view.html">View</a></li><li><a style="margin-left:0;" class="" href="docs/image.html">Image</a></li><li><a style="margin-left:0;" class="" href="docs/text.html">Text</a></li></ul></div><div class="nav-docs-section"><h3>react vr components</h3><ul><li><a style="margin-left:0;" class="" href="docs/mesh.html">Mesh</a></li><li><a style="margin-left:0;" class="" href="docs/pano.html">Pano</a></li><li><a style="margin-left:0;" class="" href="docs/scene.html">Scene</a></li><li><a style="margin-left:0;" class="" href="docs/sound.html">Sound</a></li><li><a style="margin-left:0;" class="" href="docs/vrbutton.html">VrButton</a></li><li><a style="margin-left:0;" class="" href="docs/ambientlight.html">AmbientLight</a></li><li><a style="margin-left:0;" class="" href="docs/directionallight.html">DirectionalLight</a></li><li><a style="margin-left:0;" class="" href="docs/pointlight.html">PointLight</a></li><li><a style="margin-left:0;" class="" href="docs/spotlight.html">SpotLight</a></li></ul></div><div class="nav-docs-section"><h3>apis</h3><ul><li><a style="margin-left:0;" class="" href="docs/animated.html">Animated</a></li><li><a style="margin-left:0;" class="" href="docs/appregistry.html">AppRegistry</a></li><li><a style="margin-left:0;" class="" href="docs/appstate.html">AppState</a></li><li><a style="margin-left:0;" class="" href="docs/asyncstorage.html">AsyncStorage</a></li><li><a style="margin-left:0;" class="" href="docs/easing.html">Easing</a></li><li><a style="margin-left:0;" class="" href="docs/linking.html">Linking</a></li><li><a style="margin-left:0;" class="" href="docs/stylesheet.html">StyleSheet</a></li><li><a style="margin-left:0;" class="" href="docs/nativemethodsmixin.html">NativeMethodsMixin</a></li><li><a style="margin-left:0;" class="" href="docs/vrsoundeffects.html">VrSoundEffects</a></li><li><a style="margin-left:0;" class="" href="docs/layout-props.html">Layout Props</a></li><li><a style="margin-left:0;" class="" href="docs/layout-and-transform-props.html">Layout And Transform Props</a></li></ul></div></div></div><div class="inner-content"><a id="content"></a><h1><a class="anchor" name="native-modules"></a>Native Modules <a class="hash-link" href="docs/native-modules.html#native-modules">#</a></h1><div><p>If React VR doesn&#x27;t support a feature that you need, you can build it yourself.</p><p>Sometimes an app needs access to a platform API that React VR doesn&#x27;t have a corresponding module for yet. Maybe you want to reuse some existing JavaScript code without having to reimplement it in the React context. Or, you want to write some high performance, multi-threaded code for image processing, a database, or other advanced extensions.</p><p>This is a more advanced feature and we don&#x27;t expect it to be part of the usual development process, however it is essential that it exists.</p><h2><a class="anchor" name="cube-example"></a>Cube Example <a class="hash-link" href="docs/native-modules.html#cube-example">#</a></h2><p>One example of using Native Modules is to support interaction between a React VR UI element and a custom Three.js object that you&#x27;ve added to your scene, for example a geometric cube similar to the one in the <a href="https://github.com/mrdoob/three.js" target="_blank">Three.js README</a>.</p><h3><a class="anchor" name="setting-up-the-scene"></a>Setting up the Scene <a class="hash-link" href="docs/native-modules.html#setting-up-the-scene">#</a></h3><p>The React VR framework can handle the camera and renderer setup for you, so you only need to focus on adding objects to your scene and animating them. First, we create the scene in the <code>init</code> function of <code>vr/client.js</code> (one of the files provided as part of the Starter Project) and provide it as an option to the <code>VRInstance</code> constructor.  We also create <code>CubeModule</code>, a Native Module described later in this section.</p><div class="prism language-javascript">  const scene <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Scene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  const cubeModule <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CubeModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  const vr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VRInstance</span><span class="token punctuation">(</span>bundle<span class="token punctuation">,</span> <span class="token string">&#x27;CubeSample&#x27;</span><span class="token punctuation">,</span> parent<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    cursorVisibility<span class="token punctuation">:</span> <span class="token string">&#x27;visible&#x27;</span><span class="token punctuation">,</span>
    nativeModules<span class="token punctuation">:</span> <span class="token punctuation">[</span> cubeModule <span class="token punctuation">]</span><span class="token punctuation">,</span>
    scene<span class="token punctuation">:</span> scene<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><p>Next, we create the cube mesh and add it to the scene.  We use the same Three.js operations as we normally would, with a couple modifications which are often necessary to make Three.js objects appear correctly in React VR.</p><ul><li>React VR uses units of 1 meter, so we use cube dimensions of 1 instead of 100.</li><li>The VRInstance camera is at the origin, so we change the z position of the cube so it is visible.</li></ul><div class="prism language-javascript">  const cube <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>
    <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BoxGeometry</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  cube<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">;</span>
  scene<span class="token punctuation">.</span><span class="token function">add<span class="token punctuation">(</span></span>cube<span class="token punctuation">)</span><span class="token punctuation">;</span>
  cubeModule<span class="token punctuation">.</span><span class="token function">init<span class="token punctuation">(</span></span>cube<span class="token punctuation">)</span><span class="token punctuation">;</span></div><p>Above, we also initialize the <code>cubeModule</code> with a handle to the cube.  Finally, add the per-frame update logic into the <code>vr.render</code> method.</p><div class="prism language-javascript">  vr<span class="token punctuation">.</span>render <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>timestamp<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    const seconds <span class="token operator">=</span> timestamp <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">;</span>
    cube<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">*</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">cos<span class="token punctuation">(</span></span>seconds<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cube<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">0.2</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">abs<span class="token punctuation">(</span></span>Math<span class="token punctuation">.</span><span class="token function">sin<span class="token punctuation">(</span></span>seconds<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span></div><h3><a class="anchor" name="using-the-native-module"></a>Using the Native Module <a class="hash-link" href="docs/native-modules.html#using-the-native-module">#</a></h3><p>Let&#x27;s say we want the cube to change color based on UI interaction such as a button click.  Here is a Native Module that implements the <code>changeCubeColor</code> function, which is called asynchronously across the React Native bridge.  The <code>constructor</code> and <code>init</code> methods are called directly in <code>client.js</code> to setup the module, as shown above.</p><div class="prism language-javascript">export default class <span class="token class-name">CubeModule</span> extends <span class="token class-name">Module</span> <span class="token punctuation">{</span>
  <span class="token function">constructor<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">super<span class="token punctuation">(</span></span><span class="token string">&#x27;CubeModule&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">init<span class="token punctuation">(</span></span>cube<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>cube <span class="token operator">=</span> cube<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">changeCubeColor<span class="token punctuation">(</span></span>color<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>cube<span class="token punctuation">.</span>material<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Color</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></div><p>Now we can call the <code>changeCubeColor</code> method from <code>index.vr.js</code>, for example in an <code>onClick</code> handler.</p><div class="prism language-javascript">import NativeModules from <span class="token string">&#x27;react-vr&#x27;</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
const CubeModule <span class="token operator">=</span> NativeModules<span class="token punctuation">.</span>CubeModule<span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token function">render<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  &lt;VrButton
    onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">&gt;</span>CubeModule<span class="token punctuation">.</span><span class="token function">changeCubeColor<span class="token punctuation">(</span></span>hexColor<span class="token punctuation">)</span><span class="token punctuation">}</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  &lt;<span class="token operator">/</span>VrButton<span class="token operator">&gt;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span></div><p>See the <code>CubeSample</code> for the full code of this example.</p></div><div class="docs-prevnext"><a class="docs-prev" href="docs/timers.html#content">← Prev</a><a class="docs-next" href="docs/platform-specific-information.html#content">Next →</a></div><p class="edit-page-block">You can <a target="_blank" href="https://github.com/facebookincubator/react-vr/issues">file an issue on GitHub</a> if you see a typo or error on this page!</p></div></section><footer class="nav-footer"><section class="sitemap"><a href="./index.html" class="nav-home"><img src="img/header_logo.png" alt="React Native" width="66" height="58"></a><div><h5>Docs</h5><a href="docs/getting-started.html">Getting Started</a><a href="docs/tutorial.html">Tutorial</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource"><img src="img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"></a><section class="copyright">Copyright © 2017 Facebook Inc.</section></footer></div><div id="fb-root"></div><script src="js/scripts.js"></script></body></html>